<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Content Manager</title>
		<script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
	</head>
	<body>
		<!-- Include the script that builds the page and powers Netlify CMS -->
		<script src="https://unpkg.com/netlify-cms@2.9.7/dist/netlify-cms.js"></script>
		<script>
			CMS.registerEditorComponent({
				// Internal id of the component
				id: "image",
				// Visible label
				label: "TestImage",
				// Fields the user need to fill out when adding an instance of the component
				fields: [
					{
						name: "image",
						label: "Image",
						widget: "image",
						media_library: {
							allow_multiple: false,
						},
					},
					{
						name: "alt",
						label: "Alt Text",
						widget: "string",
					},
				],
				// Pattern to identify a block as being an instance of this component
				pattern: /^!\[(.*)\]\((.*?)(\s"(.*)")?\)$/,
				// Function to extract data elements from the regexp match
				fromBlock: function (match) {
					return {
						image: match[2],
						alt: match[1],
						/* title: match[4], */
					};
				},
				// Function to create a text block from an instance of this component
				toBlock: function (obj) {
					return `![${obj.alt || ""}](${obj.image || ""})`;
				},
				// Preview output for this component. Can either be a string or a React component
				// (component gives better render performance)
				toPreview: function (obj) {
					return `<img src=${obj.src + "?nf_resize=fitp&w=400"} alt=${
						obj.alt
					} />`;
				},
			});
		</script>
	</body>
</html>
